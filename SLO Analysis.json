{"version":13,"variables":[{"key":"AppName","type":"code","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n const lastXDays = 1;\n const usqlQuery = 'SELECT DISTINCT application FROM useraction';\n const response = await rumUserSessionsClient.getUsqlResultAsTable({query: usqlQuery, startTimestamp: Date.now() - lastXDays * 24 * 60 * 60 * 1000});\n const sampleCount = response.values.length;\n function flatten(arr) {\n    var flat = [];\n    for (var i = 0; i < sampleCount; i++) {\n        flat = flat.concat(arr[i]);\n    }\n    return flat;\n}\n return( flatten(response.values))\n}","multiple":true},{"key":"SLO","type":"csv","input":"1,2,3,4,5,6,7,8,9,10,11,12","multiple":false},{"key":"ActionCategory","type":"csv","input":"All,Key,Entry,Exit","multiple":false},{"key":"KPI","type":"csv","input":"Duration,VisuallyCompleteTime,SpeedIndex,LoadEventEnd,FirstInputDelay,CumulativeLayoutShift,LargestContentfulPaint,CdnBusyTime,CdnResources,DocumentInteractiveTime,DomCompleteTime,DomContentLoadedTime,FirstPartyBusyTime,FirstPartyResources,FrontendTime,LoadEventStart,NavigationStart,NetworkTime,RequestStart,ResponseEnd,ResponseStart,ServerTime,ThirdPartyBusyTime,ThirdPartyResources","multiple":false},{"key":"ActionType","type":"csv","input":"Load, Xhr","multiple":true},{"key":"TimeShift","type":"csv","input":"1,7,14,21","multiple":false}],"tiles":{"5":{"type":"code","title":"Percent Traffic Increase for $KPI SLO Violation ","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricAgg = \"avg\";\n  const last30Days = (Math.round(new Date().getTime() / 1000)- (720 * 3600))*1000;\n  var chartInterval = \"30m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isexitaction is true limit 5000';\n  const response = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery,offsetUtc: -300,startTimestamp:last30Days });\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let ChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]!==null)\n      {\n      if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n      }\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  ChangeMetric = (Number(metricAAVG/i2A) - Number(metricBAVG/i2B));\n  percentChangeTraffic = (Number(trafficAAVG/i2A) - Number(trafficBAVG/i2B))/Number(trafficBAVG/i2B)*100;\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change Percent:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG/i2B)\n  console.log(\"Metric Average:\",metricAVG/sampleCount)\n  console.log(\"Metric Above:\",metricAAVG/i2A)\n  console.log(\"Metric Change:\",ChangeMetric)\n  if ((($SLO*1000)-(metricAVG/sampleCount))*(percentChangeTraffic/ChangeMetric)<=0) return \"N/A\";\n  if ($SLO*1000<=(metricAVG/sampleCount)) return \"N/A\";\n  return (($SLO*1000)-(metricAVG/sampleCount))*(percentChangeTraffic/ChangeMetric);\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":2,"color":"#F8312F","comparator":">","label":"","value":0}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false},"colorThresholdTarget":"value","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"element","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"11":{"type":"markdown","title":"","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"12":{"type":"markdown","title":"","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"23":{"type":"code","title":"Average $KPI","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricAgg = \"avg\";\n  const last30Days = (Math.round(new Date().getTime() / 1000)- (720 * 3600))*1000;\n  var chartInterval = \"30m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isexitaction is true limit 5000';\n  const response = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery,offsetUtc: -300,startTimestamp:last30Days });\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let ChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]!==null)\n      {\n      if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n      }\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG/i2B)\n  console.log(\"Metric Average:\",metricAVG/sampleCount)\n  console.log(\"Metric Above:\",metricAAVG/i2A)\n  console.log(\"Metric Change:\",ChangeMetric)\n  return metricAVG/sampleCount;\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"≥","label":"","value":0},{"id":1,"color":"#FCD53F","comparator":"≥","label":"","value":3000},{"id":2,"color":"#F8312F","comparator":"≥","label":"","value":12000}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false},"colorThresholdTarget":"value","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"element","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[{"valueAxis":"element","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"24":{"type":"code","title":"Percent Traffic Increase for $KPI SLO Warning","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricAgg = \"avg\";\n  const last30Days = (Math.round(new Date().getTime() / 1000)- (720 * 3600))*1000;\n  var chartInterval = \"30m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isexitaction is true limit 5000';\n  const response = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery,offsetUtc: -300,startTimestamp:last30Days });\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let ChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]!==null)\n      {\n      if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n      }\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  ChangeMetric = (Number(metricAAVG/i2A) - Number(metricBAVG/i2B));\n  percentChangeTraffic = (Number(trafficAAVG/i2A) - Number(trafficBAVG/i2B))/Number(trafficBAVG/i2B)*100;\n  console.log(\"Traffic Below:\",trafficBAVG/i2B)\n  console.log(\"Traffic Average:\",trafficAVG/sampleCount)\n  console.log(\"Traffic Above:\",trafficAAVG/i2A)\n  console.log(\"Traffic Change Percent:\",percentChangeTraffic)\n  console.log(\"Metric Min:\",metricMIN)\n  console.log(\"Metric Below:\",metricBAVG/i2B)\n  console.log(\"Metric Average:\",metricAVG/sampleCount)\n  console.log(\"Metric Above:\",metricAAVG/i2A)\n  console.log(\"Metric Change:\",ChangeMetric)\n  if ((($SLO*1000)-(metricAVG/sampleCount))*(percentChangeTraffic/ChangeMetric)<=0) return \"N/A\";\n  if ($SLO*1000<=(metricAVG/sampleCount)) return \"N/A\";\n  return (($SLO*1000)-(metricAVG/sampleCount))*(percentChangeTraffic/ChangeMetric)*.9;\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":1,"color":"#FCD53F","comparator":">","label":"","value":0}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false},"colorThresholdTarget":"value","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"element","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"25":{"type":"code","title":"Apdex Trend","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  const startShiftTime = startTime-(86400000*$TimeShift);       // Get TimeShift variable, convert to days and create startShift\n  const endShiftTime = endTime-(86400000*$TimeShift);           // Get TimeShift variable, convert to days and create endShift\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  const query = 'SELECT CONDITION (count(*),WHERE apdexcategory=\"SATISFIED\" and starttime>='+startTime+' and endtime<='+endTime+') as \"CSatisfied\", CONDITION (count(*),WHERE apdexcategory=\"TOLERATING\" and starttime>='+startTime+' and endtime<='+endTime+') as \"CTolerated\", CONDITION (count(*),WHERE apdexcategory=\"FRUSTRATED\" and starttime>='+startTime+' and endtime<='+endTime+') as \"CFrustrated\", CONDITION (count(*),WHERE apdexcategory=\"SATISFIED\" and starttime>='+startShiftTime+' and endtime<='+endShiftTime+') as \"PSatisfied\", CONDITION (count(*),WHERE apdexcategory=\"TOLERATING\" and starttime>='+startShiftTime+' and endtime<='+endShiftTime+') as \"PTolerated\", CONDITION (count(*),WHERE apdexcategory=\"FRUSTRATED\" and starttime>='+startShiftTime+' and endtime<='+endShiftTime+') as \"PFrustrated\" FROM useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+')';\n  export default async function () {\n  const result = await rumUserSessionsClient.getUsqlResultAsTable({query: query, startTimestamp: startShiftTime, endTimestamp: endTime});\n  if ((result[\"values\"][0][0] + (result[\"values\"][0][1]/2))/(result[\"values\"][0][0] + result[\"values\"][0][1] + result[\"values\"][0][2]) > (result[\"values\"][0][3] + (result[\"values\"][0][4]/2))/(result[\"values\"][0][3] + result[\"values\"][0][4] + result[\"values\"][0][5])) \n   return \"🟢\";\n  else if ((result[\"values\"][0][0] + (result[\"values\"][0][1]/2))/(result[\"values\"][0][0] + result[\"values\"][0][1] + result[\"values\"][0][2]) < (result[\"values\"][0][3] + (result[\"values\"][0][4]/2))/(result[\"values\"][0][3] + result[\"values\"][0][4] + result[\"values\"][0][5]))\n   return \"🔴\";\n  else\n   return \"🟡\";\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","autoscale":true,"recordField":"element"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"26":{"type":"code","title":"Avg $KPI","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricAgg = \"avg\";\n  const last30Days = (Math.round(new Date().getTime() / 1000)- (720 * 3600))*1000;\n  var chartInterval = \"30m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isexitaction is true limit 5000';\n  const response = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery,offsetUtc: -300,startTimestamp:last30Days });\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let ChangeMetric = 0;\n  let percentChangeTraffic = 0;\n  let trafficAVG = 0;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricAAVG = 0;\n  let metricBAVG = 0;\n  let trafficAAVG = 0;\n  let trafficBAVG = 0;\n  let c = 0;\n  while (c < sampleCount) {\n    trafficAVG = trafficAVG + response.values[c][1];\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    c++;\n  }\n  let i2 = 0;\n  let i2A = 0;\n  let i2B = 0;\n    while (i2 < sampleCount) {\n          if (response.values[i2][1]>(trafficAVG/sampleCount))\n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricAAVG=metricAAVG+response.values[i2][2];\n              trafficAAVG=trafficAAVG+response.values[i2][1];\n              i2A++;\n                  }\n            }\n          if (response.values[i2][1]<(trafficAVG/sampleCount)) \n            {\n              if (response.values[i2][2]!=null)\n                {\n              metricBAVG=metricBAVG+response.values[i2][2];\n              trafficBAVG=trafficBAVG+response.values[i2][1];\n              i2B++;\n                  }\n            }\n          i2++;\n        }\n  if ((metricAVG/sampleCount)>=12000) \n   return \"🔴\";\n  else if ((metricAVG/sampleCount)>=3000) \n   return \"🟡\";\n  else\n   return \"🟢\";\n }","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","autoscale":true,"recordField":"element"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"27":{"type":"code","title":"Requests Trend","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\nexport default async function () {\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  const startShiftTime = startTime-(86400000*$TimeShift);       // Get TimeShift variable, convert to days and create startShift\n  const endShiftTime = endTime-(86400000*$TimeShift);           // Get TimeShift variable, convert to days and create endShift\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  // Create the USQL query string using the values above\n    const query = 'SELECT CONDITION (count(*),WHERE starttime>='+startTime+' and endtime<='+endTime+'), CONDITION (count(*),WHERE starttime>='+startShiftTime+' and endtime<='+endShiftTime+') from useraction where useraction.type in ('+typeList+') and useraction.application in ('+appsList+')';\n  // Fire off the USQL query and get the results\n  const result = await rumUserSessionsClient.getUsqlResultAsTable({query: query, startTimestamp: startShiftTime, endTimestamp: endTime});\n  if ((result[\"values\"][0][0])>(result[\"values\"][0][1])) \n   return \"🟢\";\n  else if ((result[\"values\"][0][0])<(result[\"values\"][0][1])) \n   return \"🔴\";\n  else\n   return \"🟡\";\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","autoscale":true,"recordField":"element"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"28":{"type":"code","title":"Sessions Trend","input":"import { rumUserSessionsClient } from '@dynatrace-sdk/client-classic-environment-v1';\nexport default async function () {\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  const startShiftTime = startTime-(86400000*$TimeShift);       // Get TimeShift variable, convert to days and create startShift\n  const endShiftTime = endTime-(86400000*$TimeShift);           // Get TimeShift variable, convert to days and create endShift\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  // Create the USQL query string using the values above\n    const query = 'SELECT CONDITION (count(*),WHERE starttime>='+startTime+' and endtime<='+endTime+'), CONDITION (count(*),WHERE starttime>='+startShiftTime+' and endtime<='+endShiftTime+') from usersession where useraction.application in ('+appsList+')';\n  // Fire off the USQL query and get the results\n  const result = await rumUserSessionsClient.getUsqlResultAsTable({query: query, startTimestamp: startShiftTime, endTimestamp: endTime});\n  if ((result[\"values\"][0][0])>(result[\"values\"][0][1])) \n   return \"🟢\";\n  else if ((result[\"values\"][0][0])<(result[\"values\"][0][1])) \n   return \"🔴\";\n  else\n   return \"🟡\";\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"showLabel":false,"label":"","autoscale":true,"recordField":"element"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"29":{"type":"code","title":"Max $KPI","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricAgg = \"avg\";\n  const last30Days = (Math.round(new Date().getTime() / 1000)- (720 * 3600))*1000;\n  var chartInterval = \"30m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isexitaction is true limit 5000';\n  const response = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery,offsetUtc: -300,startTimestamp:last30Days });\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricMAX = response.values[0][2];\n  let c = 0;\n  while (c < sampleCount) {\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    if (response.values[c][2]>metricMAX) metricMAX=response.values[c][2];\n    c++;\n  }\n  if (metricMAX>=12000) \n   return \"🔴\";\n  else if (metricMAX>=3000) \n   return \"🟡\";\n  else\n   return \"🟢\";\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"≥","label":""},{"id":1,"color":{"Default":"var(--dt-colors-charts-categorical-color-14-default, #d56b1a)"},"comparator":"≥","label":""},{"id":2,"color":{"Default":"var(--dt-colors-charts-categorical-color-12-default, #cd3741)"},"comparator":"≥","label":""}]}],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","autoscale":true,"recordField":"element"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"unitsOverrides":[{"identifier":"element","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1708618424986}],"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"30":{"type":"code","title":"Min $KPI","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricAgg = \"avg\";\n  const last30Days = (Math.round(new Date().getTime() / 1000)- (720 * 3600))*1000;\n  var chartInterval = \"30m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\", count(*) AS \"Count\", '+metricAgg+'('+metric+') AS \"Metric\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isexitaction is true limit 5000';\n  const response = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery,offsetUtc: -300,startTimestamp:last30Days });\n  if (response.values.length<6) return \"Try increasing the timeframe.\";\n  const sampleCount = response.values.length-6;\n  let metricAVG = 0;\n  let metricMIN = response.values[0][2];\n  let metricMAX = response.values[0][2];\n  let c = 0;\n  while (c < sampleCount) {\n    metricAVG = metricAVG + response.values[c][2];\n    if (response.values[c][2]<metricMIN) metricMIN=response.values[c][2];\n    if (response.values[c][2]>metricMAX) metricMAX=response.values[c][2];\n    c++;\n  }\n  if (metricMIN>=12000) \n   return \"🔴\";\n  else if (metricMIN>=3000) \n   return \"🟡\";\n  else\n   return \"🟢\";\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"≥","label":""},{"id":1,"color":{"Default":"var(--dt-colors-charts-categorical-color-14-default, #d56b1a)"},"comparator":"≥","label":""},{"id":2,"color":{"Default":"var(--dt-colors-charts-categorical-color-12-default, #cd3741)"},"comparator":"≥","label":""}]}],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","autoscale":true,"recordField":"element"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"unitsOverrides":[{"identifier":"element","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1708618424986}],"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"33":{"type":"markdown","title":"","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"36":{"type":"code","title":"$KPI SLO","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  if (timeDiff>.5)\n    var chartInterval = \"10m\"\n  if (timeDiff>1)\n    var chartInterval = \"1h\"\n  var query = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') limit 5000';\n  if ($ActionCategory==\"Key\") query = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") query = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isentryaction is true limit 5000';\n  if ($ActionCategory==\"Exit\") query = 'SELECT DISTINCT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"'+chartInterval+'\") AS \"Date\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isexitaction is true limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: query, startTimestamp: startTime, endTimestamp: endTime});\n  const sampleCount = response.values.length;\n  return {\n    records: new Array(sampleCount).fill(null).map((_, index, array) => {\n      return {\n        Date: response.values[index][0],\n        'SLO Success': response.values[index][1],\n        'SLO Warning': response.values[index][2],\n        'SLO Failure': response.values[index][3]\n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n         Date: { type: 'timestamp' },\n          'SLO Success': { type: 'double' },\n          'SLO Warning': { type: 'double' },\n          'SLO Failure': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"areaChart","visualizationSettings":{"thresholds":[{"id":1,"field":"","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"≥","label":""},{"id":1,"color":{"Default":"var(--dt-colors-charts-categorical-color-14-default, #d56b1a)"},"comparator":"≥","label":""},{"id":2,"color":{"Default":"var(--dt-colors-charts-categorical-color-12-default, #cd3741)"},"comparator":"≥","label":""}]}],"chartSettings":{"gapPolicy":"connect","legend":{"position":"bottom","hidden":false},"seriesOverrides":[{"seriesId":["SLO Failure"],"override":{"color":"#F8312F"}},{"seriesId":["SLO Warning"],"override":{"color":"#FCD53F"}},{"seriesId":["SLO Success"],"override":{"color":"#00D26A"}}],"categoricalBarChartSettings":{},"fieldMapping":{"timestamp":"Date","leftAxisValues":["SLO Success","SLO Warning","SLO Failure"],"leftAxisDimensions":[],"fields":[],"values":[],"rightAxisValues":[]}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"Date"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"unitsOverrides":[],"histogram":{"dataMappings":[{"valueAxis":"SLO Success","rangeAxis":""},{"valueAxis":"SLO Warning","rangeAxis":""},{"valueAxis":"SLO Failure","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"37":{"type":"code","title":"SLO Failure","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricAgg = \"avg\";\n  const last30Days = (Math.round(new Date().getTime() / 1000)- (720 * 3600))*1000;\n  var chartInterval = \"30m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isexitaction is true limit 5000';\n  const response = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery,offsetUtc: -300,startTimestamp:last30Days });\n  return (response.values[0][0]/(response.values[0][0]+response.values[0][1]+response.values[0][2]))*100;\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":2,"color":"#F8312F","comparator":"≥","label":"","value":0}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false},"colorThresholdTarget":"value","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"element","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[{"valueAxis":"element","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"38":{"type":"code","title":"SLO Success","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricAgg = \"avg\";\n  const last30Days = (Math.round(new Date().getTime() / 1000)- (720 * 3600))*1000;\n  var chartInterval = \"30m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isexitaction is true limit 5000';\n  const response = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery,offsetUtc: -300,startTimestamp:last30Days });\n  return (response.values[0][1]/(response.values[0][0]+response.values[0][1]+response.values[0][2]))*100;\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":0,"color":"#00D26A","comparator":"≥","label":"","value":0}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false},"colorThresholdTarget":"value","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"element","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[{"valueAxis":"element","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"39":{"type":"code","title":"SLO Warning","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const metric = $KPI;\n  const metricAgg = \"avg\";\n  const last30Days = (Math.round(new Date().getTime() / 1000)- (720 * 3600))*1000;\n  var chartInterval = \"30m\"\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  var usqlQuery = 'SELECT CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') limit 5000';\n  if ($ActionCategory==\"Key\") usqlQuery = 'SELECT CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and keyuseraction is true limit 5000';\n  if ($ActionCategory==\"Entry\") usqlQuery = 'SELECT CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isentryaction is true  limit 5000';\n  if ($ActionCategory==\"Exit\") usqlQuery = 'SELECT CONDITION(count(*), WHERE duration>('+$SLO+'*1000)) AS \"Breach Count\",CONDITION(count(*), WHERE duration<=('+$SLO+'*1000)) AS \"Success Count\",CONDITION(count(*), WHERE duration>('+$SLO+'*900) and duration<=('+$SLO+'*1000)) AS \"Warn Count\" from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isexitaction is true limit 5000';\n  const response = await  rumUserSessionsClient.getUsqlResultAsTable({ query: usqlQuery,offsetUtc: -300,startTimestamp:last30Days });\n  return (response.values[0][2]/(response.values[0][0]+response.values[0][1]+response.values[0][2]))*100;\n}","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"element","title":"","isEnabled":true,"rules":[{"id":1,"color":"#FCD53F","comparator":"≥","label":"","value":0}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","trend":{"isVisible":false},"sparklineSettings":{"isVisible":false},"colorThresholdTarget":"value","recordField":"element"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"element","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1701281148734}],"histogram":{"dataMappings":[{"valueAxis":"element","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"40":{"type":"code","title":"Traffic vs $KPI","input":"import { rumUserSessionsClient } from \"@dynatrace-sdk/client-classic-environment-v1\";\nexport default async function () {\n  const startTime = Date.parse($dt_timeframe_from).toString();  // Get Dashboard Start Time\n  const endTime = Date.parse($dt_timeframe_to).toString();      // Get Dashboard End Time\n  var appsList = \"\\\"\"+$AppName[0]+\"\\\"\";\n  let i = 1;\n  // Build Apps List\n  while (i < 10) {\n    if ($AppName[i]==null) break;\n    appsList = appsList+\",\\\"\"+$AppName[i]+\"\\\"\";\n    i++;\n  }\n  var typeList = \"\\\"\"+$ActionType[0]+\"\\\"\";\n  let t = 1;\n  // Build Type List\n  while (t < 3) {\n    if ($ActionType[t]==null) break;\n    typeList = typeList+\",\\\"\"+$ActionType[t]+\"\\\"\";\n    t++;\n  }\n  // Calculate Chart Interval\n  const timeDiff = (endTime-startTime)/3600/1000/24;\n  var chartInterval = \"5m\"\n  if (timeDiff>.5)\n    var chartInterval = \"10m\"\n  if (timeDiff>1)\n    var chartInterval = \"1h\"\n  var query = 'SELECT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"1h\") AS \"Date\", count(*),avg(useraction.'+$KPI+') from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') GROUP BY  DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"1h\") limit 5000';\n  if ($ActionCategory==\"Key\") query = 'SELECT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"1h\") AS \"Date\", count(*),avg(useraction.'+$KPI+') from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and keyuseraction is true GROUP BY  DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"1h\") limit 5000';\n  if ($ActionCategory==\"Entry\") query = 'SELECT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"1h\") AS \"Date\", count(*),avg(useraction.'+$KPI+') from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isentryaction is true GROUP BY  DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"1h\") limit 5000';\n  if ($ActionCategory==\"Exit\") query = 'SELECT DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"1h\") AS \"Date\", count(*),avg(useraction.'+$KPI+') from useraction WHERE useraction.type in ('+typeList+') and useraction.application in ('+appsList+') and isexitaction is true GROUP BY  DATETIME(endTime,  \"MM-dd HH:mm:ss\",\"1h\") limit 5000';\n  const response = await rumUserSessionsClient.getUsqlResultAsTable({query: query, startTimestamp: startTime, endTimestamp: endTime});\n  const sampleCount = response.values.length;\n  return {\n    records: new Array(sampleCount).fill(null).map((_, index, array) => {\n      return {\n        Date: response.values[index][0],\n        'Traffic': response.values[index][1],\n        'KPI': response.values[index][2]\n      };\n    }),\n    types: [\n      {\n        indexRange: [0, sampleCount],\n        mappings: {\n         Date: { type: 'timestamp' },\n          'Traffic': { type: 'double' },\n          'KPI': { type: 'double' }\n        },\n      },\n    ],\n  };\n}","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","legend":{"position":"bottom","hidden":false},"seriesOverrides":[{"seriesId":["KPI"],"override":{"color":"#00D26A"}},{"seriesId":"Traffic","override":{"color":"#0096FF"}}],"categoricalBarChartSettings":{},"fieldMapping":{"timestamp":"Date","leftAxisValues":["Traffic","KPI"],"leftAxisDimensions":[],"rightAxisValues":[]}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"Date"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"unitsOverrides":[{"identifier":"KPI","unitCategory":"time","baseUnit":"millisecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1708629609749}],"histogram":{"dataMappings":[{"valueAxis":"Traffic","rangeAxis":""},{"valueAxis":"KPI","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"41":{"type":"markdown","title":"","content":"## Last 30 Days"},"42":{"type":"markdown","title":"","content":"## Current Timeframe"},"43":{"type":"markdown","title":"","content":"![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABy8AAAAMCAYAAADbJPG3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACdSURBVHhe7dtBFcAgDETBUBtFA6KrDhf0gofsYeay8fBfRn37FAAAAAAAAECz5y4AAAAAAABAK/ESAAAAAAAAiCBeAgAAAAAAABHESwAAAAAAACCCeAkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEGG8c517AwAAAAAAALTxeQkAAAAAAABEEC8BAAAAAACACOIlAAAAAAAAEKDqB2IIBAQ2TEouAAAAAElFTkSuQmCC)"},"44":{"type":"markdown","title":"","content":"# \n# 🔎 SLO Analysis"}},"layouts":{"5":{"x":18,"y":5,"w":6,"h":2},"11":{"x":0,"y":0,"w":24,"h":1},"12":{"x":0,"y":3,"w":24,"h":1},"23":{"x":0,"y":5,"w":3,"h":2},"24":{"x":12,"y":5,"w":6,"h":2},"25":{"x":21,"y":1,"w":3,"h":2},"26":{"x":12,"y":1,"w":3,"h":2},"27":{"x":9,"y":1,"w":3,"h":2},"28":{"x":6,"y":1,"w":3,"h":2},"29":{"x":15,"y":1,"w":3,"h":2},"30":{"x":18,"y":1,"w":3,"h":2},"33":{"x":0,"y":7,"w":24,"h":1},"36":{"x":0,"y":9,"w":12,"h":7},"37":{"x":9,"y":5,"w":3,"h":2},"38":{"x":3,"y":5,"w":3,"h":2},"39":{"x":6,"y":5,"w":3,"h":2},"40":{"x":12,"y":9,"w":12,"h":7},"41":{"x":0,"y":4,"w":24,"h":1},"42":{"x":0,"y":8,"w":24,"h":1},"43":{"x":0,"y":16,"w":24,"h":1},"44":{"x":0,"y":1,"w":6,"h":2}}}